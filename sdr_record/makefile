CFLAGS=-c -std=gnu99 -Wall -g
CPPFLAGS=-c -std=c++11 -Wall -g
LFLAGS=`pkg-config --cflags --libs librtlsdr` -pthread -lrt
.PHONY: clean test all

all: sdr_record

sdr_record: sdr_record.o queue.o
	gcc sdr_record.o queue.o $(LFLAGS) -o sdr_record

clean:
	-rm -rf *.o
	-rm -rf sdr_record
	-rm -rf rtl_sdr
	-rm -rf test
	-rm -rf raw_data_to_complex
	-rm -rf switch_iq
	-rm -rf fopentest
	-rm -rf rtl_sdr
	-rm -rf maxmin
	-rm -rf sample_mag
	-rm -rf gmon.out

sdr_record.o: sdr_record.c queue.h
	gcc sdr_record.c $(CFLAGS)

queue.o: queue.c
	gcc queue.c $(CFLAGS)

test: sdr_record
	-mkdir test
	./sdr_record -r 1 -o test -d 0 &
	./sdr_record -r 1 -o test -d 1 &
	sleep 5
	sudo killall sdr_record -SIGINT

raw_data_to_complex: raw_data_to_complex.c
	gcc raw_data_to_complex.c $(CFLAGS)
	gcc raw_data_to_complex.o $(LFLAGS) -o raw_data_to_complex

switch_iq: switch_iq.c
	gcc switch_iq.c $(CFLAGS)
	gcc switch_iq.o $(LFLAGS) -o switch_iq

sample_mag: sample_mag.c
	gcc -std=gnu99 sample_mag.c -o sample_mag -lm

maxmin: maxmin.c
	gcc -std=gnu99 maxmin.c -o maxmin
